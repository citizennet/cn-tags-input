"use strict";function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){function t(t){_.forOwn(t,function(t,e,n){_.set(n,e,null)})}function e(){var e={};return{on:function(t,n){return t.split(" ").forEach(function(t){e[t]||(e[t]=[]),e[t].push(n)}),this},trigger:function(t,n){return angular.forEach(e[t],function(t){t.call(null,n)}),this},destroy:function(){t(e),e=null}}}function n(t,e,n){return t=t||[],t.length>0&&!angular.isObject(t[0])&&t.forEach(function(i,a){t[a]=_defineProperty({},e,i),n&&(t[a][n]=i)}),t}function i(t,e){return"object"===e.arrayValueType?(t||[]).map(function(t){return _.isObject(t&&t[e.valueProperty])?t[e.valueProperty]:t}):_.pluck(t,e.valueProperty)}function a(t,e,n){var i=null,a=0,s=t.length;if(_.isFunction(n)){var o=n(e);if(!o)return null;for(;a<s;a++)if(o===n(t[a])){i=t[a];break}}else for(;a<s;a++)if(_.has(e,n)&&_.has(t[a],n)&&(angular.toJson(t[a][n])+"").toLowerCase()===(angular.toJson(e[n])+"").toLowerCase()){i=t[a];break}return i}function s(t,e,n){var i=e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");return t.replace(new RegExp(i,"gi"),n)}function o(t,e,n){if(!e||!t||!t.length)return!1;if(!_.isArray(e))return angular.equals(e,t[0][n.valueProperty])||angular.equals(e,t[0]);var a=i(t,n);return _.some(a,function(t,i){return angular.equals(e[i],t)||angular.equals(e[i],t[n.valueProperty])})}function r(t,e,n){if(_.isArray(e)){var i=_.filter(t,function(t){return _.find(e,function(e){return l(t,e,n.valueProperty,n.arrayValueType)})});return!n.addFromAutocompleteOnly&&i.length<e.length&&_.each(e,function(t){_.find(i,function(e){return l(e,t,n.valueProperty,n.arrayValueType)})||i.push(t)}),i}return _.filter(t,function(t){return l(t,e,n.valueProperty,n.modelType)})}function l(t,e,n,i){var a=n?t[n]:t;return"object"===i?u(e,a):e==a}function u(t,e){return angular.isArray(t)?angular.equals(t,e):_.every(t,function(t,n){return"$$hashKey"===n||(angular.isObject(t)?u(t,e[n]):t==e[n])})}function g(t){t.value&&t.setSelectionRange(0,t.value.length)}function c(t,e,n){var i=function(t){return n&&t[n]?t[n]:t},a=_.remove(t,function(t){return _.startsWith(i(t),i(e))});a=_.sortBy(a,[function(t){return i(t).length}]);var s=new RegExp(i(e),"i"),o=_.remove(t,function(t){return s.test(i(t))});o=_.sortBy(o,[function(t){return i(t).search(s)},function(t){return i(t).length}]);var r=_.sortBy(t,[function(t){return i(t).length}]);return a.concat(o,r)}function p(t){if(_.isString(t)){var e=document.createElement("textarea");e.style.position="fixed",e.style.opacity="0",e.textContent=t;var n=document.getElementsByTagName("body")[0];n.appendChild(e),e.select(),document.execCommand("copy"),n.removeChild(e)}}var d={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,comma:188},f=angular.module("cnTagsInput",[]);f.directive("tagsInput",["$timeout","$document","tagsInputConfig","$sce","$rootScope",function(s,r,l,u,c){function f(e,n){var i,s,o,r={};return i=e.getTagText=function(t){return _.isObject(t)?e.itemFormatter?e.itemFormatter(t):t[e.displayProperty]:t},s=function(t,n){t[e.displayProperty]||(t[e.displayProperty]=n,e.valueProperty&&!_.has(t,e.valueProperty)&&(t[e.valueProperty]=n))},o=function(t){var n=i(t)+"";return(!e.minLength||n.length>=e.minLength)&&(!e.maxLength||n.length<=e.maxLength)&&e.allowedTagsPattern.test(n)&&!a(r.items,t,e.valueProperty||i)},r.items=[],r.addText=function(t){var e={};s(e,t),r.add(e)},r.add=function(t){if(!t.disabled){var a=i(t);return a.trim&&(a=a.trim()),e.replaceSpacesWithDashes&&(a=a.replace(/\s/g,"-")),s(t,a),o(t)?(e.maxTags&&r.items.length>=e.maxTags&&(r.items.pop(),n.trigger("tag-removed",{$tag:t,$event:"tag-removed"})),r.items.push(t),n.trigger("tag-added",{$tag:t,$event:"tag-added"})):n.trigger("invalid-tag",{$tag:t,$event:"invalid-tag"}),t}},r.remove=function(t){var e=r.items.splice(t,1)[0];return n.trigger("tag-removed",{$tag:e,$event:"tag-removed"}),e},r.removeLast=function(){var t,n=r.items.length-1;return e.enableEditingLastTag||r.selected?(r.selected=null,t=r.remove(n)):r.selected||(r.selected=r.items[n]),t},r.removeAll=function(t){t.preventDefault();var e=r.items.splice(0,r.items.length);e.forEach(function(t){n.trigger("tag-removed",{$tag:t,$event:"tag-removed"})})},r.copyAllToClipboard=function(){return p(r.items.map(i).join("\n"))},r.destroy=function(){t(r),r=null},r}return{restrict:"E",require:"ngModel",scope:{tags:"=ngModel",itemFormatter:"=",ngDisabled:"=",onBeforeTagAdded:"&",onBeforeTagRemoved:"&",onBeforeTagChanged:"&",onTagAdded:"&",onTagRemoved:"&",onTagChanged:"&",onInit:"&",newTag:"=?"},replace:!1,transclude:!0,templateUrl:"cnTagsInput/tags-input.html",controller:["$scope","$attrs","$element",function(n,i,a){function s(t){n.events.trigger("input-keydown",t)}l.load("tagsInput",n,i,{placeholder:[String,""],tabindex:[Number],removeTagSymbol:[String,String.fromCharCode(215)],replaceSpacesWithDashes:[Boolean,!1],minLength:[Number,2],maxLength:[Number],addOnEnter:[Boolean,!0],addOnSpace:[Boolean,!1],addOnComma:[Boolean,!0],addOnBlur:[Boolean,!1],clearOnBlur:[Boolean,!1],allowedTagsPattern:[RegExp,/.+/],enableEditingLastTag:[Boolean,!1],required:[Boolean,!1],minTags:[Number],maxTags:[Number],displayProperty:[String,"text"],valueProperty:[String],allowLeftoverText:[Boolean,!1],addFromAutocompleteOnly:[Boolean,!1],tagClass:[String,""],modelType:[String,"array"],arrayValueType:[String,"object"],hideTags:[Boolean,!1],dropdownIcon:[Boolean,!1],tagsStyle:[String,"tags"],allowBulk:[Boolean,!1],bulkSingleRequest:[String,""],bulkDelimiter:[RegExp,/, ?|\n/],bulkPlaceholder:[String,"Enter a list separated by commas or new lines"],sortFilteredResults:[Boolean,!1],showClearAll:[Boolean,!1],showClearCache:[Boolean,!1],showButton:[Boolean,!1]});var o=n.options,r=o.input=a.find("input.input");r.on("keydown",s),n.$on("$destroy",function(){r.off("keydown",s),r=null,t(o),o=null,n.events.destroy(),n.tagList.destroy(),n.processBulk=null}),o.valueProperty||/object|array/.test(o.modelType)&&"object"===o.arrayValueType||(o.valueProperty="value"),n.itemFormatter&&(o.itemFormatter=n.itemFormatter),"tags"===o.tagsStyle&&(o.tagClass=o.tagClass||"label-primary"),!o.allowBulk||"array"===o.modelType&&1!==o.maxTags||(o.allowBulk=!1),n.events=new e,n.tagList=new f(o,n.events),this.registerAutocomplete=function(){return{addTag:function(t){return n.tagList.add(t)},focusInput:function(){r[0].focus()},blurInput:function(){r[0].blur()},getTags:function(){return n.tagList.items},getModel:function(){return n.tags},getOptions:function(){return o},on:function(t,e){return n.events.on(t,e),this},registerProcessBulk:function(t){n.processBulk=function(){t(n.bulkTags).then(function(){n.showBulk=!1,n.bulkTags=""})}},registerSuggestionList:function(t){n.tagList.suggestionList=t}}}}],link:function(t,e,a,l){function c(){}function p(t,e){return function(){var n=arguments;t.apply(this,n),s(function(){e.apply(this,n)})}}function f(){return function(){if(arguments.length>0&&_.isArray(arguments[0].$tag)){var e=arguments[0].$tag,n=_.every(e,function(t){return"object"===("undefined"==typeof t?"undefined":_typeof(t))&&null!==t&&L.displayProperty&&t[L.displayProperty]});n&&t.tagList&&t.tagList.items&&e&&(t.tagList.items=e)}}}function m(e){if(!e.isImmediatePropagationStopped||!e.isImmediatePropagationStopped()){var n,i,a=e.keyCode,s=e.shiftKey||e.altKey||e.ctrlKey||e.metaKey,o={};if(!s&&w.indexOf(a)!==-1)if(o[d.enter]=L.addOnEnter,o[d.comma]=L.addOnComma,o[d.space]=L.addOnSpace,n=!L.addFromAutocompleteOnly&&o[a],i=!n&&a===d.backspace&&0===t.newTag.text.length,n)x.addText(t.newTag.text),t.$apply(),e.preventDefault();else if(i){var r=x.removeLast();r&&L.enableEditingLastTag&&(t.newTag.text=r[L.displayProperty]),t.$apply(),e.preventDefault()}}}function h(n){T=s(function(){if(!P)return!1;var i=r.prop("activeElement"),a=i===P[0],s=e.find(".host")[0].contains(i);!a&&s||(t.hasFocus=!1,k.trigger("input-blur",n))},150)}function y(e){e&&e.preventDefault(),t.ngDisabled||(g(e.target),T&&s.cancel(T),t.hasFocus=!0,k.trigger("input-focus",P.val()),/apply|digest/.test(t.$root.$$phase)||t.$apply())}function v(e){e.keyCode===d.enter&&(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),t.processBulk()))}function b(t){var e=$(t.target);e.closest(".suggestion").length||e.closest(".overflows-to-tooltip").length||e.parent().hasClass("help-block")||(t.preventDefault(),P[0].focus())}t.__tag=new c;var T,w=[d.enter,d.comma,d.space,d.backspace],x=t.tagList,k=t.events,L=t.options,P=e.find("input.input"),I=e.find("textarea"),B=e.find("div");a.inputId&&!l.$name&&(l.$name=a.inputId),k.on("tag-added",p(t.onBeforeTagAdded,t.onTagAdded)).on("tag-removed",p(t.onBeforeTagRemoved,t.onTagRemoved)).on("tag-changed",p(t.onBeforeTagChanged,t.onTagChanged)).on("tag-changed",f()).on("tag-init",t.onInit).on("tag-added tag-removed",function(e){!L.maxTags||L.maxTags>t.tagList.items.length?g(L.input[0]):t.newTag.text="","array"===L.modelType?(L.valueProperty?t.tags=i(t.tagList.items,L):t.tags=t.tagList.items,t.tagList.items.length>=L.minTags&&l.$setValidity("tv4-400",!0)):"tag-removed"===e.$event?t.tags=void 0:L.valueProperty?t.tags=_.has(e.$tag,L.valueProperty)?e.$tag[L.valueProperty]:e.$tag[L.displayProperty]:t.tags=e.$tag}).on("invalid-tag",function(){t.newTag.invalid=!0}).on("input-change",function(){x.selected=null,t.newTag.invalid=null}).on("input-focus",function(){l.$setValidity("leftoverText",!0)}).on("input-blur",function(){L.addFromAutocompleteOnly||L.addOnBlur&&t.newTag.text&&x.addText(t.newTag.text),L.clearOnBlur&&(t.newTag.text="",t.newTag.invalid=null)}),t.newTag={text:"",invalid:null},t.getDisplayText=t.itemFormatter||function(t){return t&&((t[L.displayProperty]||"undefined")+"").trim()},t.getDisplayHtml=function(e){return u.trustAsHtml(t.getDisplayText(e))},t.handleShowTooltip=function(t){var e=$(t.target).closest(".tag-item.overflows-to-tooltip");e.outerWidth()===e.offsetParent().width()&&e.find(".tag-overflow-tooltip").fadeIn(200)},t.handleHideTooltip=function(t){$(t.target).closest(".tag-item.overflows-to-tooltip").find(".tag-overflow-tooltip").fadeOut(200)},t.track=function(t){return t[L.displayProperty]},t.newTagChange=function(){k.trigger("input-change",t.newTag.text)},t.processBulk=t.processBulk||function(){var e=t.bulkTags.split(L.bulkDelimiter);_.each(e,function(e){var n={};n[L.displayProperty]=e,t.tagList.add(n)}),t.showBulk=!1,t.bulkTags=""};var S=!0;t.triggerInit=function(t,e){var n=L.valueProperty?_defineProperty({},L.valueProperty,t):t;x.items.length&&_.find(x.items,n)||k.trigger("tag-init",{$tag:t,$prev:e,$event:"tag-init",$setter:function(t){if(t&&!_.isObject(t)){var e;x.items=[(e={},_defineProperty(e,L.displayProperty,t),_defineProperty(e,L.valueProperty,t),e)]}else x.items=_.isArray(t)?t:[t];return x.items}})},t.$watch("tags",function(e,a){var s=!angular.equals(e,a),r=!s&&S;if(r&&t.triggerInit(e,a),s&&k.trigger("tag-changed",{$tag:e,$prev:a,$event:"tag-changed"}),"array"===L.modelType){if(_.isArray(e)){if(e.length){if(o(x.items,t.tags,L)||t.triggerInit(e,a),!o(x.items,t.tags,L)||x.items.length!==t.tags.length)return x.items=n(e,L.displayProperty,L.valueProperty),void(t.tags=i(x.items,L))}else if(x.items=[],angular.isUndefined(a))return}else if(void 0===e)return x.items=[],void(t.tags=[])}else if(angular.isDefined(e))if(_.isArray(e)){if(e.length)return void(L.valueProperty?t.tags=e[0][L.valueProperty]:t.tags=e[0]);t.tags=void 0}else if("object"===L.modelType)null!==e&&(x.items=[e]);else{if(_.isObject(e)){x.items=[e];var u=e[L.valueProperty];return _.isUndefined(u)&&(u=e[L.displayProperty]),void(t.tags=u)}_.isUndefined(e)||x.items.length&&x.items[0][L.valueProperty]===e||t.triggerInit(e,a)}else!e&&x.items.length&&(x.items=[]);!r&&s&&l.$setDirty(),l.$setValidity("schemaForm",!0),"array"===L.modelType?(l.$setValidity("tv4-401",!e||!L.maxTags||e.length<=L.maxTags),l.$setValidity("tv4-302",!!e&&(!angular.isDefined(L.minTags)||e.length>=L.minTags))):l.$setValidity("tv4-302",!L.required||!angular.isUndefined(e)),S=!1},!0);var C=s(function(){P.on("keydown",m).on("focus",y).on("blur",h)});I.on("keydown",v),B.on("click",b),t.$on("$destroy",function(){P.off("keydown",m).off("focus",y).off("blur",h),I.off("keydown",v),B.off("click",b),P=null,I=null,B=null,k.destroy(),k=null,S=null,w=null,L=null,x=null,s.cancel(C)})}}}]),f.directive("autoComplete",["$document","$timeout","$filter","$sce","tagsInputConfig","$parse","Api","$q",function(e,i,o,l,u,g,p,f){function m(t,e){var s,r,l,u,p,d,m,h={};return u=function(t,e){var n,i={},a=[],s=0;return _.each(t,function(t){n=g(e)(t),_.isArray(n)||(n=[n]),_.each(n,function(e){i[e]||(i[e]=[]),i[e].push(t)})}),_.each(i,function(t){t.indexes=[],_.each(t,function(e){t.indexes.push(s++),a.push(e)})}),{groups:i,map:a}},d=function(t,e){return e?(_.isArray(e)||(e=[e,{}]),g(e[0])((e[1].val=t)&&e[1])):t},p=function(n){function i(t,n,i,a){var s=_.isObject(n)?n[a||e.tagsInput.displayProperty]:n,o={text:d(s,i.formatter),value:s,key:t,childKey:a};_.find(i.items,o)||i.items.push(o)}var a=[];return _.each(t.searchKeys,function(t){var e=t.key;t.items=[],_.each(n,function(n){n[e]&&(_.isArray(n[e])?_.each(n[e],function(n){i(e,n,t,t.childKey)}):i(e,n[e],t,t.childKey))}),a.push(t)}),a},m=function(t){var e=[],n=0;return _.each(t,function(t){t.indexes=[],_.each(t.items,function(i){t.indexes.push(n++),e.push(i)})}),e},r=function(t,n){return n.length?t.filter(function(t){return!a(n,t,e.tagsInput.valueProperty||e.tagsInput.getTagText)}):t.filter(function(t){return""!==t[e.tagsInput.displayProperty]})},h.reset=function(){l=null,h.items=[],h.visible=!1,h.index=-1,h.selected=null,h.query=null,i.cancel(s)},h.show=function(){h.selected=null,h.visible=!0,h.select(0)},h.load=function(a,g){if(a.length<e.minLength)return void h.reset();var d,f,y=a,v=function(i){d&&d!==l||(t.searchKeys&&(t.isGroups=!0,i=p(i)),_.isObject(i)&&!_.isArray(i)&&(t.isGroups=!0,i=_.map(i,function(t,e){return{items:t,label:e}})),t.isGroups?(_.each(i,function(t){if(t.items=r(t.items,g),a){var n={};t.items.map(function(t,e){t.__uniqueid=_.uniqueId("__uniqueid"),n[t.__uniqueid]=_.cloneDeep(t),"key"in t&&delete t.key,"childKey"in t&&delete t.childKey}),t.items=o("cnFilter")(t.items,y),e.tagsInput.sortFilteredResults&&(t.items=c(t.items,y,e.tagsInput.displayProperty)),t.items.map(function(t){var e=n[t.__uniqueid];"key"in e&&(t.key=e.key),"childKey"in e&&(t.childKey=e.childKey),delete t.__uniqueid})}t.items=t.items.slice(0,e.maxResultsToShow)}),h.itemMap=m(i)):(i=n(i.data||i,e.tagsInput.displayProperty),i=r(i,g),a&&!e.skipFiltering&&(i=o("cnFilter")(i,y)),e.tagsInput.sortFilteredResults&&(i=c(i,y,e.tagsInput.displayProperty)),i=i.slice(0,e.maxResultsToShow),e.groupBy&&(f=u(i,e.groupBy),i=f.groups,h.itemMap=f.map)),h.items=i,h.show())};i.cancel(s),h.query=a,s=i(function(){h._load(a,d).then(v)},e.minLength?e.debounceDelay:0,!1)},h.clearCache=function(e,n){e.preventDefault(),t._source&&(t.source=t._source);var i=t.source;i({$query:n,options:{refreshData:!0}}).then(function(e){t._source=i,t.source=function(){return e},t.tagsInput.focusInput()})},h._load=function(e,n){var a=f.defer(),s=t.source({$query:e});return _.isArray(s)?(i(function(){a.resolve(s||[])}),a.promise):(n=s,l=n,n)},h.selectNext=function(){h.select(++h.index)},h.selectPrior=function(){h.select(--h.index)},h.select=function(t){var e=h.itemMap||h.items;t<0?t=e.length-1:t>=e.length&&(t=0),h.index=t,h.itemMap?h.selected=h.itemMap[t]:h.selected=h.items[t]},h}return{restrict:"E",require:"^tagsInput",scope:{source:"&",searchKeys:"=?"},templateUrl:function(t,e){return e.customTemplateUrl||"cnTagsInput/auto-complete.html"},link:function(n,i,a,g){function f(){}var h,y,v,b,T,w=[d.enter,d.tab,d.escape,d.up,d.down];n.__tag=new f,u.load("autoComplete",n,a,{debounceDelay:[Number,250],minLength:[Number,3],singleQuery:[Boolean,!1],highlightMatchedText:[Boolean,!0],maxResultsToShow:[Number,75],groupBy:[String,""],skipFiltering:[Boolean,!1]}),v=n.options,y=g.registerAutocomplete(),n.tagsInput=y,v.tagsInput=y.getOptions(),0===v.minLength?(v.tagsInput.dropdownIcon=!0,1===v.tagsInput.maxTags?v.tagsInput.dropdownStyle="caret":v.tagsInput.dropdownStyle="fa fa-plus"):v.tagsInput.dropdownStyle="fa fa-search",h=new m(n,v),y.registerSuggestionList(h),b=v.tagsInput.itemFormatter||function(t){return String(t[v.tagsInput.displayProperty])},n.suggestionList=h;var x=y.getModel();v.singleQuery&&x&&!angular.equals(x,[])&&h._load().then(function(t){var e=r(t,x,v.tagsInput),n=y.getTags();angular.equals(e,n)||(n.length=0,e.forEach(function(t){return y.addTag(t)}))}),n.addSuggestion=function(t){t.preventDefault();var e=!1;if(h.selected){if(y.addTag(angular.copy(h.selected)),!v.tagsInput.maxTags||y.getTags().length<v.tagsInput.maxTags){var n=h.items.indexOf(h.selected);h.items.splice(n,1),h.select(n),y.focusInput()}else h.reset(),y.blurInput();e=!0}return e},n.highlight=function(t,e){var n=b(t,e);return h.query&&v.highlightMatchedText&&(n=_(n.match(/(<[^>]*>|[^<]*)/g)).map(function(t){return t.length&&"<"!==t[0]?s(t,h.query,"<b>$&</b>"):t}).join("")),l.trustAsHtml("<a>"+n+"</a>")},n.track=function(t,e){return b(t,e)},n.noResultsMessage=function(t){var e=(t.visible,t.query);return e?l.trustAsHtml("No results for <b>"+e+"</b>..."):"No options..."},y.registerProcessBulk(function(t){var e=t.split(v.tagsInput.bulkDelimiter),i=function(t){return function(e){_.times(t,function(t){e[t]&&y.addTag(e[t])})}};if(v.tagsInput.bulkSingleRequest){var a=JSON.parse(v.tagsInput.bulkSingleRequest);return p.post({url:a.url,data:{location_types:a.location_types,terms:e}}).then(function(t){t.map(function(t){y.addTag(t)})})}return p.batch(function(){for(var t=0,a=e.length;t<a&&!(v.tagsInput.maxTags&&y.getTags().length>=v.tagsInput.maxTags);t++){var s=e[t],r=1,l=e[t].match(/(.*) ?\[(\d+)\]$/);l&&(s=l[1],r=parseInt(l[2]));var u=n.source({$query:s});if(_.isArray(u)){if(u.length){if(!v.skipFiltering){var g=s;u=o("cnFilter")(u,g)}v.tagsInput.sortFilteredResults&&(u=c(u,s,v.tagsInput.displayProperty)),i(r)(u)}else if(!v.tagsInput.addFromAutocompleteOnly){var p;y.addTag((p={},_defineProperty(p,v.tagsInput.displayProperty,s),_defineProperty(p,v.tagsInput.valueProperty,s),p))}}else u.then&&u.then(i(r))}})}),y.on("input-change",function(t){t||!v.minLength?h.load(t,y.getTags()):h.reset()}).on("input-focus",function(t){h.visible||h.load(t,y.getTags())}).on("input-keydown",function(t){var e,i;if(w.indexOf(t.keyCode)!==-1){var a=!1;t.stopImmediatePropagation=function(){a=!0,t.stopPropagation()},t.isImmediatePropagationStopped=function(){return a},h.visible&&(e=t.keyCode,i=!1,e===d.down?(h.selectNext(),i=!0):e===d.up?(h.selectPrior(),i=!0):e===d.escape?(h.reset(),i=!0):e===d.enter&&(i=n.addSuggestion(t)),i&&(t.preventDefault(),t.stopImmediatePropagation(),n.$apply()))}}).on("input-blur",function(t){h.reset()}),T=function(t){t.isDefaultPrevented()||h.visible&&(!$(t.target).closest(".suggestion").length&&$(t.target).closest(i[0]).length||"blur"===t.type&&!/^(input|select|textarea|button|a)$/i.test(t.target.tagName)||(h.reset(),/apply|digest/.test(n.$root.$$phase)||n.$apply()))},e.on("click",T).on("blur",T),n.$on("$destroy",function(){e.off("click",T).off("blur",T),t(y),y=null,t(v),v=null})}}}]),f.directive("tiTranscludeAppend",function(){return function(t,e,n,i,a){a(function(t){e.append(t)})}}),f.directive("tiAutosize",function(){return{restrict:"A",require:"ngModel",link:function(t,e,n,i){var a,s,o=3;a=angular.element('<span class="input"></span>'),a.css("display","none").css("visibility","hidden").css("width","auto").css("white-space","pre"),e.parent().append(a),s=function(t){var i,s=t;return angular.isString(s)&&0===s.length&&(s=n.placeholder),s&&(a.text(s),a.css("display",""),i=a.prop("offsetWidth"),a.css("display","none")),e.css("width",i?i+o+"px":""),t},i.$parsers.unshift(s),i.$formatters.unshift(s),n.$observe("placeholder",function(t){i.$modelValue||s(t)})}}}),f.provider("tagsInputConfig",function(){var t={},e={};this.setDefaults=function(e,n){return t[e]=n,this},this.setActiveInterpolation=function(t,n){return e[t]=n,this},this.$get=["$interpolate",function(n){var i={};return i[String]=function(t){return t},i[Number]=function(t){return parseInt(t,10)},i[Boolean]=function(t){return"true"===t.toLowerCase()},i[RegExp]=function(t){return new RegExp(t)},i[Object]=function(t){return"object"===("undefined"==typeof t?"undefined":_typeof(t))?t:Object(t)},{load:function(a,s,o,r){s.options={},s.attrs=o,s.uid=_.uniqueId(),angular.forEach(r,function(r,l){var u,g,c,p,d;u=r[0],g=r[1],c=i[u],p=function(){var e=t[a]&&t[a][l];return angular.isDefined(e)?e:g},d=function(t){s.options[l]=t?c(t):p()},s[l]?d(s[l]):e[a]&&e[a][l]?o.$observe(l,function(t){d(t)}):d(o[l]&&n(o[l])(s.$parent))})}}}]}),f.run(["$templateCache",function(t){t.put("cnTagsInput/tags-input.html",'\n        <ul class="list-group cn-autocomplete-list"\n            ng-if="options.tagsStyle === \'list\' && tagList.items.length && !options.hideTags">\n          <li class="list-group-item {{options.tagClass}}"\n              ng-repeat="tag in tagList.items"\n              ng-class="{ selected: tag == tagList.selected }">\n            <button ng-if="!ngDisabled"\n                    ng-click="tagList.remove($index)"\n                    type="button" class="close pull-right">\n              <span>&times;</span>\n            </button>\n            <span class="tag-item" ng-bind-html="getDisplayHtml(tag)"/>\n          </li>\n        </ul>\n        <div class="host clearfix"\n             ng-hide="showBulk"\n             ti-transclude-append="">\n          <!-- hack to avoid browser\'s autocomplete -->\n          <input class="offscreen"\n                 id="fake-{{attrs.id && attrs.id}}-input"\n                 name="fake-{{attrs.id && attrs.id}}-input">\n          <!-- end hack to avoid browser\'s autocomplete -->\n          <div class="input form-control tags"\n               ng-class="{focused: hasFocus}"\n               ng-disabled="ngDisabled">\n            <input class="input"\n                   ng-disabled="ngDisabled"\n                   id="{{attrs.inputId || attrs.id && attrs.id + \'-input-\' + uid}}"\n                   name="{{attrs.inputId || attrs.id && attrs.id + \'-input-\' + uid}}"\n                   placeholder="{{options.placeholder}}"\n                   tabindex="{{options.tabindex}}"\n                   ng-model="newTag.text"\n                   ng-model-options="{updateOn: \'default\'}"\n                   ng-change="newTagChange()"\n                   ng-trim="false"\n                   ng-class="{\n                      \'invalid-tag\': newTag.invalid,\n                      \'hide-below\': options.maxTags === 1 && tagList.items.length\n                   }"\n                   ti-autosize=""\n                   autocomplete="off">\n            <span class="tag-item label {{options.tagClass}} label-block"\n                  ng-if="options.tagsStyle !== \'list\' && !options.hideTags && options.maxTags === 1 && tagList.items.length"\n                  title="{{getDisplayText(tagList.items[0])}}">\n              <span ng-bind-html="getDisplayHtml(tagList.items[0])"/>\n              <a class="remove-button"\n                 ng-if="!ngDisabled && !options.dropdownIcon"\n                 ng-click="tagList.remove()">\n                <span>&times;</span>\n              </a>\n            </span>\n            <ul class="tag-list"\n                ng-if="options.tagsStyle !== \'list\' && !options.hideTags && options.maxTags !== 1">\n              <li class="tag-item label {{options.tagClass}} overflows-to-tooltip"\n                  ng-class="{ selected: tag == tagList.selected }"\n                  ng-mouseenter="handleShowTooltip($event)"\n                  ng-mouseleave="handleHideTooltip($event)"\n                  ng-repeat="tag in tagList.items">\n                <div class="overflows-to-tooltip"\n                  ng-bind-html="getDisplayHtml(tag)"/>\n                  <a class="remove-button"\n                     ng-if="!ngDisabled"\n                     ng-click="tagList.remove($index)">\n                    <span>&times;</span>\n                  </a>\n                <div class="tag-overflow-tooltip"\n                      ng-if="getDisplayText(tag).length > 30">\n                  {{ getDisplayText(tag) }}\n                </div>\n              </li>\n            </ul>\n            <button ng-if="options.showButton && options.dropdownIcon"\n                    class="btn form-control-icon" ng-disabled="ngDisabled" tabindex="-1">\n              <i class="{{options.dropdownStyle}}"></i>\n            </button>\n          </div>\n        </div>\n        <div class="help-block">\n          <button\n            class="btn btn-default btn-xs"\n            ng-show="options.allowBulk && !showBulk"\n            ng-click="showBulk = true"\n          > Batch\n          </button>\n          <button\n            class="btn btn-default btn-xs"\n            ng-show="options.showClearAll && tagList.items.length"\n            ng-click="tagList.removeAll($event)"\n          > Clear\n          </button>\n          <button\n            class="btn btn-default btn-xs"\n            ng-show="options.showClearCache && tagList.suggestionList"\n            ng-click="tagList.suggestionList.clearCache($event, newTag.text)"\n          > <i class="fa fa-repeat"/> Update Data\n          </button>\n          <button\n            class="btn btn-default btn-xs"\n            ng-show="options.allowBulk && !showBulk && tagList.items.length"\n            ng-click="tagList.copyAllToClipboard()"\n          > <i class="fa fa-copy"/> Copy\n          </button>\n        </div>\n        <div ng-show="showBulk" class="clearfix">\n          <textarea class="form-control" ng-model="bulkTags" ng-model-options="{\'updateOn\': \'input\'}" placeholder="{{options.bulkPlaceholder}}"></textarea>\n          <p class="help-block">\n            Press "Enter" to submit, "Shift+Enter" to add a new line\n          </p>\n          <p class="help-block">\n            Add multiple with brackets, eg. "citizennet[10]"\n          </p>\n          <div class="btn-group help-block">\n            <button class="btn btn-default btn-xs" ng-click="showBulk = false">Cancel</button>\n          </div>\n        </div>'),t.put("cnTagsInput/auto-complete.html",'\n        <div ng-if="!suggestionList.items.length && !options.groupBy"\n             ng-class="{open: suggestionList.visible}">\n          <ul class="autocomplete dropdown-menu">\n            <li class="dropdown-header" ng-bind-html="suggestionList.visible && noResultsMessage(suggestionList)"></li>\n          </ul>\n        </div>\n        <div ng-if="suggestionList.items.length && isGroups"\n             ng-class="{open: suggestionList.visible}">\n          <ul class="autocomplete dropdown-menu">\n            <li ng-if="!suggestionList.items[0].items.length && !suggestionList.items[1].items.length" class="dropdown-header">No results...</li>\n            <li ng-repeat-start="group in suggestionList.items"></li>\n            <li class="dropdown-header" ng-show="group.items.length">{{group.label | titleCase}}</li>\n            <li ng-repeat="item in group.items"\n                class="suggestion"\n                ng-class="{selected: item == suggestionList.selected, disabled: item.disabled}"\n                ng-click="addSuggestion($event)"\n                ng-mouseenter="suggestionList.select(group.indexes[$index])"\n                ng-bind-html="highlight(item, group.label)">\n            </li>\n            <li class="divider" ng-show="!$last && $parent.suggestionList.items[$index+1].items.length"></li>\n            <li ng-repeat-end></li>\n          </ul>\n        </div>\n        <div ng-if="suggestionList.items.length && !isGroups && !options.groupBy"\n             ng-class="{open: suggestionList.visible}">\n          <ul class="autocomplete dropdown-menu">\n            <li ng-repeat="item in suggestionList.items"\n                class="suggestion"\n                ng-class="{selected: item == suggestionList.selected, disabled: item.disabled}"\n                ng-click="addSuggestion($event)"\n                ng-mouseenter="suggestionList.select($index)"\n                ng-bind-html="highlight(item)">\n            </li>\n          </ul>\n        </div>\n        <div ng-if="!isGroups && options.groupBy"\n             ng-class="{open: suggestionList.visible}">\n          <ul class="autocomplete dropdown-menu">\n            <li ng-repeat-start="(group, items) in suggestionList.items"></li>\n            <li class="dropdown-header" ng-show="items.length">{{group | titleCase}}</li>\n            <li ng-repeat="item in items"\n                class="suggestion"\n                ng-class="{selected: item == suggestionList.selected, disabled: item.disabled}"\n                ng-click="addSuggestion($event)"\n                ng-mouseenter="suggestionList.select(suggestionList.items[group].indexes[$index])"\n                ng-bind-html="highlight(item)">\n            </li>\n            <li class="divider" ng-show="!$last && items.length"></li>\n            <li ng-repeat-end></li>\n          </ul>\n        </div>')}])}();
//# sourceMappingURL=all.min.js.map
